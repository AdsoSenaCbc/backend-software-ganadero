{% extends "base.html" %}
{% block title %}Actualizar Ración - Sistema Ganadero{% endblock %}
{% block content %}
<div class="form-container">
    <h2>Actualizar Ración</h2>
    <form method="POST" action="{{ url_for('racion.update_html', id=rac.id_racion) }}">
        <div class="form-group">
            <label for="id_animal">Animal</label>
            <select id="id_animal" name="id_animal" class="form-select" required>
                {% for a in animales %}
                    <option value="{{ a.id_animal }}" {% if a.id_animal == rac.id_animal %}selected{% endif %}>{{ a.nombre if a.nombre else (a.identificador_unico if a.identificador_unico else a.id_animal) }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="id_requerimiento">Requerimiento</label>
            <select id="id_requerimiento" name="id_requerimiento" class="form-select" required>
                {% for req in requerimientos %}
                    <option value="{{ req.id_requerimiento }}" {% if req.id_requerimiento == rac.id_requerimiento %}selected{% endif %}>Etapa {{ req.etapa.nombre }} (ID {{ req.id_requerimiento }})</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="ms_total">MS Total</label>
            <input type="number" step="0.01" id="ms_total" name="ms_total" value="{{ rac.ms_total }}">
        </div>
        <div class="form-group">
            <label for="calculado_por">Calculado Por</label>
            <select id="calculado_por" name="calculado_por" class="form-select">
                {% for u in usuarios %}
                    <option value="{{ u.id_usuario }}" {% if u.id_usuario|string == rac.calculado_por|string %}selected{% endif %}>{{ u.nombres }} {{ u.apellidos }} (ID {{ u.id_usuario }})</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="observaciones">Observaciones</label>
            <textarea id="observaciones" name="observaciones">{{ rac.observaciones }}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        <a href="{{ url_for('racion.index_html') }}" class="btn btn-secondary ms-2">Volver</a>
    </form>
</div>
{% endblock %}